<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tristan Mahr" />

<meta name="date" content="2022-10-19" />

<title>polypoly package overview</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">polypoly package overview</h1>
<h4 class="author">Tristan Mahr</h4>
<h4 class="date">2022-10-19</h4>


<div id="TOC">
<ul>
<li><a href="#background" id="toc-background">Background</a></li>
<li><a href="#examples" id="toc-examples">Examples</a>
<ul>
<li><a href="#tidying" id="toc-tidying">Tidying</a></li>
<li><a href="#plotting" id="toc-plotting">Plotting</a></li>
<li><a href="#rescaling-a-matrix" id="toc-rescaling-a-matrix">Rescaling
a matrix</a></li>
<li><a href="#adding-columns-to-a-dataframe" id="toc-adding-columns-to-a-dataframe">Adding columns to a
dataframe</a></li>
<li><a href="#experimental" id="toc-experimental">Experimental</a></li>
</ul></li>
<li><a href="#longer-example-visualizing-growth-curve-contributions" id="toc-longer-example-visualizing-growth-curve-contributions">Longer
example: Visualizing growth curve contributions</a></li>
<li><a href="#resources" id="toc-resources">Resources</a></li>
</ul>
</div>

<div id="background" class="section level2">
<h2>Background</h2>
<p>The <code>poly()</code> function in the <code>stats</code> package
creates a matrix of (orthogonal) polynomials over a set of values. The
code below shows some examples of these matrices.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># orthogonal polynomials</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">poly</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">simple =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               1          2          3</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -0.5976143  0.5455447 -0.3726780</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] -0.3585686 -0.1091089  0.5217492</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] -0.1195229 -0.4364358  0.2981424</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]  0.1195229 -0.4364358 -0.2981424</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,]  0.3585686 -0.1091089 -0.5217492</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,]  0.5976143  0.5455447  0.3726780</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the terms are uncorrelated. that&#39;s why they are &quot;orthogonal&quot;.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(<span class="fu">cor</span>(m))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1 2 3</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1 0 0</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0 1 0</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0 0 1</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># raw polynomials</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">poly</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">simple =</span> <span class="cn">TRUE</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1  2   3</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1  1   1</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 2  4   8</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 3  9  27</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 4 16  64</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 5 25 125</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 6 36 216</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># raw polynomials are highly correlated.</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(m), <span class="dv">2</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1    2    3</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1.00 0.98 0.94</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.98 1.00 0.99</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.94 0.99 1.00</span></span></code></pre></div>
<p>This package provides some helpful functions for working with these
matrices.</p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="tidying" class="section level3">
<h3>Tidying</h3>
<p>This package provides a tidying function
<code>poly_melt()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polypoly)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>poly_mat <span class="ot">&lt;-</span> <span class="fu">poly</span>(xs, <span class="at">degree =</span> <span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_melt</span>(poly_mat)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 200 × 3</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    observation degree  value</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1           1 1      -0.267</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2           2 1      -0.253</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3           3 1      -0.240</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4           4 1      -0.226</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5           5 1      -0.212</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6           6 1      -0.199</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7           7 1      -0.185</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8           8 1      -0.171</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9           9 1      -0.158</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10          10 1      -0.144</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 190 more rows</span></span></code></pre></div>
<p>The returned dataframe has one row per cell of the original matrix.
Essentialy, the columns of the matrix are stacked on top of each other
to create a long dataframe. The <code>observation</code> and
<code>degree</code> columns record each values’ original row number and
column name, respectively.</p>
</div>
<div id="plotting" class="section level3">
<h3>Plotting</h3>
<p>Plot a matrix with <code>poly_plot()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(poly_mat)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAA5FBMVEUAAAAAADoAAGYAOpAAZrYAsPYAv30zMzM6AAA6ADo6AGY6OgA6OmY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ29uQ2/+jpQCrbk2rbm6ryKur5OSr5P+2ZgC22/+2///Ijk3I///bkDrb/7bb/9vb///kq27k///na/Pr6+vy8vL4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///87xHbPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAZXklEQVR4nO2dC3vcuHWGx2uT1bqtlGycytvE28ZOk201SbOqHbX2cjrytJJl/P//E4I3XM4FIAmSIAff89jSjM7g9s4BSVwOdiJp09otXYCkaZUAb1wJ8MaVAG9cDsBffrj67ufm969/ejt5cZJCiwcsmX76VfPi01UCvD7xgL/861/Fwz//tfr94Te/6wAfGnW/OBS7XTQFnBvww29/Fl/+5Sf569c//6Xuov+uVPhyJE0kHvDn7zrAn95o1+C5vtBz2UVTwLkBKw8uf0uAtwdYXYM/XUm9SYCntZsb8Nc/vVF30cmDtwe4eQ6unTgB3iBgQnPVdy67aAoYmK5IgBfOOAGexy6aAgamKxLghTNeC+Bs4XYZa7dYxnbDBaYrEuCFM06A57FbLOPC/lxwJcCLZrwWwC7CCTCuLAGexy4BtgTqkQAPskuAZ7JLgC2BeiTAg+yKtQx0JMCD7PIEeCa7BNgSrAdPOAFGla0G8D4BHmKXFXv7c8EVyIP3CXB/u3w9HpwAD7FbE+DURQ+wS4Bns0uALcF6ZPbtwnTtMoHdIhnn+zUB5l04AUZUOjCwC0xXhATMuXACjChmwIiyfaiUzkXyEjy9AnbRjAsnD4bKDxF7MFKPBLin3foAM4QTYKB9AjyjXQJsCasHRzgBtiX5HhLguewSYEtYPeRIB0U4Aba0P6wTMEU4ATa1b26iE+CZ7OYHnB/WCZggnAAbqhxYAj6uCTDnwgmwobqHPhTHVXkw58IJsC7ZRCXg48q66ATY10468PEob6LXCBglnABrKhvoKC/BawWMEU6AlfaH4/GQAM9rNyvg4+GwbsAI4QS41bFqnJLvCgEzLpwA1yo75xZwxXelgCHhBFiqxNs0TQI8s90cGUu8WwEMCCfANV7Fd+WAbcLnDrjB2zbLIMD337yPF3Bhx6Lwa5fZ7KbNuMW7JcAm4UJ4It4iYIVX57tKwJQL1wsXCg/G2wOs4bUcuA/gx1e7Z38sAT+92+0kZ/n6x5fvTy//UL5s32x/9gKsjrZ7eH115QrpT7hwtzLFiXhrgA28XZP0Bvz46rL8J1G+EOLu+cf29eniheRav9n+7AVYHW0nD9d5+P4nf8CKsD5g4yC8LcAmXtUgvQFXvfPdN+/va++9bl+fLq6bP7Zvlj97AVbH6nyWmD+0LkzUFwVs1OOMAFt4TQfuB7jyy9PL93e7Spft69O3N+Uf2zebn70Aa0fbCdH8xhxtlxmv6t1o1garOfZbxaDj0X6n25yXy/+yPi3RAW46YBOw/iaU99F29SFKjYgvtLVHWH5lC9uO9eGteDDwXv2eRLuJ7tNFl//dP7sxXleAuzebn70A6x785YeObwLM6gjXWllX4J6AH1+9aG6ySi8tQXY3WRJw+2b7sxdg7XjZh9fa6cFUfQHhAtpxhLcAuPJeYAccuA9g4zFJImxeV4C7N9uffQCro+0Mvt6AC8yOIdzY5UqsnVPzA24658CAMd3j19x+gNXRdvXhlI67aBCoYwhgkyoOOVbA3bXXttNGBQIAlh1x9dg7HjAhqr4W4KKtmLDepiQOGE7IeCLARaXBCWq3VpadzXesB8tHIj++iwAmCZNdss3dE1ymibcUB4WWo8xkbNw5Twy4hyYG3FTNC3AJkWk/A7EPYAlV6C85Y0CUIExmbD0YmXb6wPy6AVuEi7Zyth3SfBVAFpyG2A245inMt0jGICAZNW5OZAyeew07lO8WABdd7ZyAG3gOcB1iF+AWJehhcMRwn279LhSaMTKs4QYMBgjq18E1OeCqesDOajxfcH5fBIUR2iGIC2T5av0H+BZih+A17Yyp8UGA/xdXJIBlBR2Au77X49qau+x0hJgd+iiHJwi7aWCH4jXszMUtWwLctg4G2CDc59paOzFjZ/BD7TLkW0glCI69MV8SeGnATVW3BbisIgtYuz32e/zJc9LO6oEJO80KGUs1ZBE27Ei8uh3mwCsGrBNWbbNH2q/7a9/HH/szRO58eq0hOtRmyCSs2TF4NTtr9aF1E30OgA1W3iNUOGFwA0WnlxmF6A+YxUsCVg68AcB6y2B7hgu9ymR6uPAhTXiD7LhWFz6GBuHGzoFXpYc68AYBC4RwodWYTg+XgB9Fn3HZu21PwGZF5H9OvF16drXPCrA0GDWJYH4YHcJg09NPhmQNTTsPvBTgtsRrBgxuXxo71IVBN9tvlkjvpvEhKgc39SE+Y83TvfC26TkdOBTg00tyUfxcgHHCeLu41dp1hIlRZlfPywx52aaVPPE26YEqTwX4Hlnwvg3AepOxdlTmmdtQGaNrrZiMCQcODvhW7nJYHDD2fXaPBBJSdu36CJcdUJM3MSuBWONrrZiMKQceAvgItXAXjTw+wjuOAIDrvdQedpa6rDO/jAtirRWdMeyypvLgeQHbQwjKDnnmdwz1ktLt8nwAYJWxF+Dj0TWkCTNmHXiTgJF50RCADxk1cOk3hwBXBtiqOmd+UgJmzDvw6gHjY/RgaRI7ls9It8vooWm/SaKMz7i5c+4JGLmnPCvAbWXHA8705Bg7XVauGZOxejBi5o2RjGkH3jJgc4PdARr2B5zZCfqkZ18ZMspQf+7tBZhx4CkAMwp2tF2naoshtXWu3mKXqzfG7jZsNzTmrJUpkGeGWYEdgj2Kih3z15Uw65eWiGyo0hrFt+xUGKFGIz1Y3UCjPoymhyy1yhBDOGpFrd2CQuZHUQeO1oMPRPnaGtB3x/uDxQKbjXOqtXMsZ/cGDBPCBiW9AWNLWM4FcHNegdIYwAYWzIWx9PD1ziZhYswZX14LhC5COxvA8kgoQ2C61UMYYIwwkh6+ZcEATE4p+AFG1wmrwiXAHhKqqTRBwv6AVWLcjBGyAwJq84CNmXRol9tR8Ag7TqJrKUMe88v0nqM6OX5C0AcwupXDntjcMOAcxjlE7ViJA36D5V4hQgOWCTrne4mPa0J329kOvHHAFuGAgJ1rvChAVYIe0/lOwPh+2TMCnGut0Mpv7ZuVHvGExK/SJPkI6b2uhy5p5yLsB5hcrrsRwKQL+wMmYbDrrGnAlfe6CbsAtxWzMrYXj60cMDOR39bUDEYL7RwSDApmpwRJp+2cnYQF30nvlR1RJseC+6kB3+1210TEtB6AC3qHQVdTnHAIwMxeJwKOWms1EvBesyNKtCzg2+f//eraJ3wLVb5aNGBV03GAeRDUbkWcjbHWymPskyG8EODTRemXPoAfX13LaKUekaep8tXyAYwT9gSMzQ3oIvYbY2jsuFYOwizgvWGHlWcSwI+/vhF1SLTFARs3QGbIcC49IBdgPGIAQgbGtXIDJgnvLTtQmi59+qZjCOB72ePeUi5sdNF3souWgRDnAGyGDOfSs0XOzyvlMD3IBY1rxRNmAO9tO7swKvn+gPdQxjVYerEHYHGPRRzuD5jYp2uPM0HCwQAfYCwPmwsR12oo4D2ws8qipR7Wg4UMU0lCm+IxaWLA3BKqTgCwhYWOa8USFkhStWjAwIGDA+Y63QkAF8ROezjZAwj7AHYsgmxlB2sxqLBxrTjCJGDmoKjJAVeR/X0AP76qo8KPvMnyB6w1S3DABzOwmg7FEdfKCRghzBz1ZlR7CsAsX8SD6eu1P2C7kYRdUdgwvosW3evUW+U4YGdcK44wAZg7rJFz4CCA68MavO6ia3kEIqbK15XfF7BxNosPOM+tRJW02Jddm7rjWh04wsJKrhZ7nu7kgHlhgMd30QhgYuXyPIDbJvWJa3UIC5jtoZcBfDuJB1ObDwzCTnCeuz0b5SZgr7hWeja0nUGYPdM+JsDNTRZ+eoc34AJpIkFvH8LPV6LUD7CxA8ovrpWRDW2nA8bij+CA4dbaRTxYlzraTv0WGLBO2AXOc0O+yrfbxOgb18rKiLLTGGF8kekzLdWIAKuj7dRvgwAzfLsmcgP2DKmh5Vs1cOEf1wpmRdh1kFC+MQJuH4KN52B1rI52wM6qAMtAEf5xrZCsCDtPwFioJ24Z6YSAUamDsdRvzNF2lZp9VcaGLsfWsL3xSVLEHjGH8mH721yZNali28z0zJEk+5dnOsDqaDvjkDsPD3ZvK9G1bz7Je6ZK0t+Dj8fClTmeIO7C9sgJ7r+EByPhS2b2YLk0wOiiMQ+eAnBLmAWnpegJ+Cg7ZyTeGhSSIErYGtym+OLzo4sDfnp3+fTuWj+CdsA1uC2+3j50fOdOVVOxgPUEvQDXS61kedyEsQQxwiZgkm+kgCXa20t9qFIdbad+8wSst48H4IYwY9ATcLPUqk7RSXgQYJovOj/aprcs4LsXxlBld7Sd93MwApg9D6mTOqsUldHczvS6pVZFWwReaIIIYd2O+zYygAtop72eFLC4reh6rJtl2mUwYEmYbjN74ISVWmrVJeggjCcICWt2eydgK88IAMuVH7cjhyqHA5Yb48lG6wFYX2ql0uMJ9wfMfh3nBXzPTeEHX9Ghyt82T+51zZTak4CR6UdCxqiGnhxLmEiQXsHvuKAg86PYJTjMhP/L9/LKOhNgrfj9AasTpW35AjYHrbz2a3MJkoBdt4RzAm4huwH7LJjtDzhH7Yh2IS5s+CI+IHtM0gTMuTBVQCJjNbhKp2dnNwpwDmUA9vTgO2bpxzyA8VsXuqfUBYac7ZExhjBZQLTr0Gc4yfSCAuY9+HRB3zfZXfTtyPlgvfh1lfoBRhvNBzAyowCGPvtHLUUB20sF0fS8+Abron0XvteMxyzZAYDt5ausBGgBvW3odvENa9U7ail2+47syEDSmxew59YVUXmwm++0gMEAkRMwPh+ITT/2jFoKMhfk1mYrPZDRdIDlyKOnB/v1z70Awy0knCo7m7BjQImOWobl2y9qKcjejgMdA2B56+R3DdanGQYCNoufDQNsNqJjSJiazadWaeKEvWc5mBhQbC5dIhN10aQCPweHAGwRZgHTizXIZbj+UUuRAoDLB0H4bAAj2zg5tYC1huSmZZm1OP5bYdyGqggwiiwOGE6f4T30mQLWCTMLK9ilVgxg36ilSm0hHAcha1mcCeD+y1xVKnszBWDniDnI5esXtVRTXYi98yhzlYFtR/TQ5wq4Jrw/UHzdRwiygP2iluqSxcBjUKKEtwvYruwYwFWT4oC9Q0pS+XpELTWUUTEoDxhgZHZlo4DzvltNOruGMMrXfYRgVwzSzh211FRGhCg8IICRsVlVjwRYTyhDVj35HCHoBuyMWmppz1TEJswBtm1XD7jXdk/drqjbxSZsh7VCpUrB2PFRS02VtwP+gJGxWdKBVw44P4wDXN3a6IhhWCtMzNYfu3RehvW3jKmIUWtsZCcBRtLrQvV0hNGwVog8AXNRSw3pD2wJMKgr3S6IMMBNAxNhraC4Zcem6KilmvbGkIsTMDayk+GmWHqrApw72gWRbqfSKtuYDmtli10wYYmKWqpJu0JkpJ2WJw8Y3HHHCpiSsXGu3lk3bEug/JyWmGMPH1kEl5wH4hkZk1VReaIJZohhLzkBP73zijbrL+ILiPTQ3BcfSrPLVGql+zJxxrgiOPNFo5Z22pvZZmSCba5omFumhw7lwXd+4YTDAm4rOwxw1iVX985mW5PpOcYRoLjZEGRpSZyAT//wTwsCZr74QJ1d1iXXXXzJaL1kCbzypSeskVEWMo5xoaVlpcfx9QacQSnAT7//jyW66PGAD2ZwDTLeNlEAxk4XsWhsj/B1AMbvyoMAZj347nKJa7Cq7QDA7TYe895ZtbmjpwTpscqxrRfE1lBidqvKmXiunhzw6R8/LguYvnRR9a3bpPReu0WIU2uQ7Dk7IDi9R4ZmYAjjgFm+QQDXsSqpTSnRAq47Z0CYnLVDjP17DmsFBto91wnSgImhz+kBi0Uek8wAb/0AZ2rcCrYJNe/u1X6k9OLSeGWCXCeNZXwOgN2HaBjpZfqtFUIYXTmDr53xBqytY2bwVgnihHMCsG49HWBG8QG2zohEWmUPFzcSi9/8AbcF5ty3SRAlnBNjpLwDrwwwxZe++UTqC46IxNoFYsCXr/YAXBXZgZcGnBOD4A4HPj/AyBGgeLvYKMYDLh+XXHi7a4it3C7CuQFmzxpUKjtnxJC4dO11xsQGgx6AZWq+8bTsQnYxbe2MXXxXCxisafMBLBfToXbk40+HmNoi5Au4/bL4xtMyipm3n4IrDc4HsLuTrhfT4Wb0CNWeD5bhB3ivdix4xtPSi6k+AgAbtdk4YAfh5s6ZMOKGIPdk4BZQPlzVd6QzzHnE8Nqq21ur/czabAkwtq6cA9ydzzxkEqGAO8ZRO1xwaMwv3FJbHcOaA+x3F7hiwDTh7rmXGfGipwHrXS4EYwdg9TndkHNie4TKMjUWZHs48KYAO7ehsLNOBbHWqn17j0JmAJsfMA1pxOYsEbDTAWfEn9gCbg6wNmrlWvmBrpY0mq0+dhXkawuaQUMKscvTC2Xn48DrAkzzJR4f+TMigeBTSIE1W3u+LkhP/wNeQF04Yv1ajX1hFWAvB94YYKvSJl6P5bWFcYkrULxK4ERlzhjLOEcYG3fbDGHwvHd+gC3v9dsBUTRUBe68VL6DDQFjYbxND7vNCviOOzF2VsCqRezOuccuxKIoXM4L8h1hmBuQhfmaJOzJNwxgMgjaRIC5CAndYhxTQzeKh7JzGOoxQM2/4IQz8EA/JeCn398MB6wC+T+8vrp6OxpwWXcEbwbteM0MmLHLIOICPu95j6VSgAuoDnB1pNnAFR3qQDt5pM7D9+yxOl6A4Xyv3kTrA4w4cQHs/MdSKcCcB5++vWG8mAesDtP5LDF/aF0YLV9TDTZKkfRes0Uy1M6hmABbTpxVe27mBFzJOxipKfM4LMfRds3OKmZD1/FY/cjUbqxs6N60qKRXSP5n7TEbuOVMaTrAxoF28uikRugX0OXB+qhVK8cX2veLP9ZudIJWhYxQ89wdfwgPltFmn/6t/2PSh6urX+ke/OWHji8KmLkESzuPI0BXDNiSDph9ogv1HOwf8d2UdqDdw+u36n2sfIwDuwOXEfWdyy54gupBnX9iX3okSx1oZ/DtC9gT74YAq6G2uAGro+0+XUlxd9EkYHfgMrK+c9lNknE13uYYclscMCGsfPYW2UY+gcvI+s5lN1XGziHV1QP2ClxG13cuu2gKuDLAfoHLArTLWLtoCrgqwL6BywK0y1i7aAo4iAarwIAVX+/AZSHaZaxdNAUMTFdMBtg/cFkUdtEUMDBdERCw3kP3W2sVgV00BQxMV0wCGBnWiKX9ost4bYBzYtQqlvaLLuPVASYGJWNpv+gyXhngY/+zH+Owi6aAgemKoICPJN9o2i+6jNcE+DjoeN447KIpYGC6Ihjg41F20QnwWLvAdEUowMcDiNY4a7uMtYumgIHpirA3WfS+2ljaL7qM1wOYdeBo2i+6jBPgeeyiKWBguiIBXjjjVQH2Cm0xTbuMtYumgIHpigR44YwT4HnsoilgYLoiAV444zUB5gKIxdJ+0WUcK2Cown1MXNISSh68aMaxejAoH38Jjqb9ost4RYD9YnhO1C5j7aIpYGC6IgFeOOMEeB67aAoYmK5IgBfOeD2A/QKlT9UuY+2iKWBguiIBXjjjBHgeu2gKGJiuSIAXzng9gJdtl7F20RQwMF0RCrDDgaNpv+gyToDnsYumgIHpigR44YxXA3jhdhlrF00BA9MVCfDCGa8F8FT1ncsumgIGpisS4IUzToDnsYumgIHpigR44YwT4HnsoilgYLoiAV444wR4HrtoChiYrkiAF844AZ7HLpoCBqYrEuCFM06A57GLpoCB6Yqxe5PwI9C2m178BQRKgBdNMAGOK734CwiUAC+aYOyAk6JXArxxJcAbVwK8cSXAG9cIwPXJpMFUnVMcLM2H19VZqeHK+Pnq6pchCyjP7g1aQELDAcvy1WcLB9Fn2X7B0pTHlj98/1O4MsqvX5lSyEp/Kr+BgRsR0XDA2ungAfThF/9ZphUszc+y0T68DVvGMqWACT785ndvAzcipuGAH377c+UooSTrGTTNMqGwZSxdLVyCX//8l9J7Qzci1HDAn78LDzhkmvJ4+pDpPbz+xU8BE/z0RnbPoRsRarMe/OWHN6HLGLJLKBP6GrkHh758PIS8Bpf+Vt6ihi5jwIv6pyupNzFfg2UXGPIGUNYzWJo134BlbPrSkJWWHhy6EaE2+hxcO8jbgGUsUyyvwef0HJy0CiXAG1cCvHElwBtXArxxJcAb1yYAn7698Tf+v//qZ79ynR3gc4IrlQBvXOsG/PRut3shof1xt3v+sfzlYrfbXdfvf/NenF7+Yffs7y9Lw7tv3ld/u5T/X0rI3Ud/vKg+slWtGvDTuxfVv9PF84/VT+mdp4tr+bu4e/7xdFH/LI0uH19d15xLm/Kf/lH59tJVmUyrBnwvwdxL57yu+t7Ty/fq/ZJo+7789/+lg1c29Uv7o4vWY0qtG3DVLTdgpYveVt2uuNtVqrpi6b2VF4v78q1nHeD2o5XTJ8BxCgCW/5cX34qnaMHdP/+fkvHjq2c3ugcnwCvQfcms6md1SiXo6n3RvvX46x/LL0BF9F55MPbRLWrVgO2brOrCWt1BlTQbmKVuZb8tiZ4unt1IR9dvshLgmKU/JsmLb32Zrd+ve2RRvSs77/L6/Ozfq+v0C+Mx6SYBTlqxEuCNKwHeuBLgjSsB3rgS4I0rAd64EuCNKwHeuBLgjetvs3dcHWBLpegAAAAASUVORK5CYII=" /><!-- --></p>
<p>We can also plot raw polynomials, but that display is less useful
because the <em>x</em>-axis corresponds to the row number of polynomial
matrix.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>poly_raw_mat <span class="ot">&lt;-</span> <span class="fu">poly</span>(<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(poly_raw_mat)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can make the units clearer by using
<code>by_observation = FALSE</code> so that the <em>x</em>-axis
corresponds to the first column of the polynomial matrix.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(poly_raw_mat, <span class="at">by_observation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>poly_plot()</code> returns a plain ggplot2 plot, so we can
further customize the output. For example, we can use ggplot2 to compute
the sum of the individual polynomials and re-theme the plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(poly_mat) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;sum&quot;</span>), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="st">&quot;sum&quot;</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For total customization, <code>poly_plot_data()</code> will return
the dataframe that <em>would</em> have been plotted by
<code>poly_plot()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot_data</span>(poly_mat, <span class="at">by_observation =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 200 × 4</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    observation degree   value `degree 1`</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1           1 1      -0.267      -0.267</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2           1 2       0.328      -0.267</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3           1 3      -0.360      -0.267</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4           1 4       0.369      -0.267</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5           1 5      -0.360      -0.267</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6           2 5      -0.0831     -0.253</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7           2 1      -0.253      -0.253</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8           2 2       0.278      -0.253</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9           2 3      -0.249      -0.253</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10           2 4       0.180      -0.253</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 190 more rows</span></span></code></pre></div>
</div>
<div id="rescaling-a-matrix" class="section level3">
<h3>Rescaling a matrix</h3>
<p>The ranges of the terms created by <code>poly()</code> are sensitive
to repeated values.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For each column in a matrix, return difference between max and min values</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>col_range <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(matrix, <span class="dv">2</span>, <span class="cf">function</span>(xs) <span class="fu">max</span>(xs) <span class="sc">-</span> <span class="fu">min</span>(xs))  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">poly</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">poly</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">18</span>), <span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">col_range</span>(p1)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1         2 </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.9908674 0.8703883</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">col_range</span>(p2)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1         2 </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.2335497 0.2051525</span></span></code></pre></div>
<p>Thus, two models fit with <code>y ~ poly(x, 3)</code> will not have
comparable coefficients when the number of rows changes, even if the
unique values of <code>x</code> did not change!</p>
<p><code>poly_rescale()</code> adjusts the values in the polynomial
matrix so that the linear component has a specified range. The other
terms are scaled by the same factor.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">col_range</span>(<span class="fu">poly_rescale</span>(p1, <span class="at">scale_width =</span> <span class="dv">1</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1         2 </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1.0000000 0.8784105</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">col_range</span>(<span class="fu">poly_rescale</span>(p2, <span class="at">scale_width =</span> <span class="dv">1</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1         2 </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1.0000000 0.8784105</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(<span class="fu">poly_rescale</span>(p2, <span class="at">scale_width =</span> <span class="dv">1</span>), <span class="at">by_observation =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="adding-columns-to-a-dataframe" class="section level3">
<h3>Adding columns to a dataframe</h3>
<p><code>poly_add_columns()</code> adds orthogonal polynomial
transformations of a predictor variable to a dataframe.</p>
<p>Here’s how we could add polynomials to the <code>sleepstudy</code>
dataset.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(lme4<span class="sc">::</span>sleepstudy)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 180 × 3</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Reaction  Days Subject</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1     250.     0 308    </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2     259.     1 308    </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3     251.     2 308    </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4     321.     3 308    </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5     357.     4 308    </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6     415.     5 308    </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7     382.     6 308    </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8     290.     7 308    </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9     431.     8 308    </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     466.     9 308    </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 170 more rows</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_add_columns</span>(df, Days, <span class="at">degree =</span> <span class="dv">3</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 180 × 6</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Reaction  Days Subject   Days1   Days2  Days3</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1     250.     0 308     -0.495   0.522  -0.453</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2     259.     1 308     -0.385   0.174   0.151</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3     251.     2 308     -0.275  -0.0870  0.378</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4     321.     3 308     -0.165  -0.261   0.335</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5     357.     4 308     -0.0550 -0.348   0.130</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6     415.     5 308      0.0550 -0.348  -0.130</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7     382.     6 308      0.165  -0.261  -0.335</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8     290.     7 308      0.275  -0.0870 -0.378</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9     431.     8 308      0.385   0.174  -0.151</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     466.     9 308      0.495   0.522   0.453</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 170 more rows</span></span></code></pre></div>
<p>We can optionally customize the column names and rescale the
polynomial terms.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_add_columns</span>(df, Days, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">prefix =</span> <span class="st">&quot;poly_&quot;</span>, <span class="at">scale_width =</span> <span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 180 × 6</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Reaction  Days Subject  poly_1  poly_2 poly_3</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1     250.     0 308     -0.5     0.527  -0.458</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2     259.     1 308     -0.389   0.176   0.153</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3     251.     2 308     -0.278  -0.0878  0.381</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4     321.     3 308     -0.167  -0.264   0.338</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5     357.     4 308     -0.0556 -0.351   0.131</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6     415.     5 308      0.0556 -0.351  -0.131</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7     382.     6 308      0.167  -0.264  -0.338</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8     290.     7 308      0.278  -0.0878 -0.381</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9     431.     8 308      0.389   0.176  -0.153</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     466.     9 308      0.5     0.527   0.458</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 170 more rows</span></span></code></pre></div>
<p>We can confirm that the added columns are orthogonal.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">poly_add_columns</span>(df, Days, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">scale_width =</span> <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(<span class="fu">cor</span>(df[<span class="fu">c</span>(<span class="st">&quot;Days1&quot;</span>, <span class="st">&quot;Days2&quot;</span>, <span class="st">&quot;Days3&quot;</span>)]))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Days1 Days2 Days3</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Days1     1     0     0</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Days2     0     1     0</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Days3     0     0     1</span></span></code></pre></div>
</div>
<div id="experimental" class="section level3">
<h3>Experimental</h3>
<div id="splines" class="section level4">
<h4>Splines</h4>
<p>This package also (accidentally) works on splines. Splines are not
officially supported, but they could be an avenue for future
development.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(splines<span class="sc">::</span><span class="fu">bs</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">10</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_plot</span>(splines<span class="sc">::</span><span class="fu">ns</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">10</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="longer-example-visualizing-growth-curve-contributions" class="section level2">
<h2>Longer example: Visualizing growth curve contributions</h2>
<p>This section illustrates a use case that may or may not be included
in the package someday: Visualizing the weighting of polynomial terms
from a linear model. For now, here’s how to do that task with this
package.</p>
<p>Suppose we want to model some change over time using a cubic
polynomial. For example, the growth of trees.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(Orange)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Tree <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>Tree)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 35 × 3</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Tree    age circumference</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1       118            30</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1       484            58</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1       664            87</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1      1004           115</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1      1231           120</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1      1372           142</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1      1582           145</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 2       118            33</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 2       484            69</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 2       664           111</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 25 more rows</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> circumference, <span class="at">color =</span> Tree) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can bind the polynomial terms onto the data and fit a model.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">poly_add_columns</span>(Orange, age, <span class="dv">3</span>, <span class="at">scale_width =</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>(circumference) <span class="sc">~</span> age1 <span class="sc">+</span> age2 <span class="sc">+</span> age3 <span class="sc">+</span> (age1 <span class="sc">+</span> age2 <span class="sc">+</span> age3 <span class="sc">|</span> Tree), </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: scale(circumference) ~ age1 + age2 + age3 + (age1 + age2 + age3 |  </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Tree)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: df</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: -11.7</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.54075 -0.42547  0.08553  0.49188  1.37391 </span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr             </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Tree     (Intercept) 0.12584  0.35474                   </span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           age1        0.38473  0.62027   0.99            </span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           age2        0.00997  0.09985  -0.63 -0.49      </span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           age3        0.01070  0.10343  -0.89 -0.95  0.19</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Residual             0.01688  0.12991                   </span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 35, groups:  Tree, 5</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -1.867e-14  1.602e-01   0.000</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age1         2.719e+00  2.852e-01   9.533</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age2        -1.520e-01  7.995e-02  -1.901</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age3        -2.529e-01  8.085e-02  -3.128</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      (Intr) age1   age2  </span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age1  0.950              </span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age2 -0.348 -0.266       </span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age3 -0.502 -0.529  0.062</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span></code></pre></div>
<p>How do we understand the contribution of each of these terms? We can
recreate the model matrix by attaching the intercept term to a
polynomial matrix.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>poly_mat <span class="ot">&lt;-</span> <span class="fu">poly_rescale</span>(<span class="fu">poly</span>(df<span class="sc">$</span>age, <span class="at">degree =</span> <span class="dv">3</span>), <span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only seven rows because there are 7 observations per tree</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>poly_mat <span class="ot">&lt;-</span> poly_mat[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>pred_mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">constant =</span> <span class="dv">1</span>, poly_mat)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>pred_mat</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      constant           1          2          3</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]        1 -0.54927791  0.5047675 -0.2964647</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]        1 -0.29927791 -0.1637435  0.4264971</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]        1 -0.17632709 -0.3312105  0.2957730</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]        1  0.05591335 -0.3573516 -0.2139411</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,]        1  0.21096799 -0.1635520 -0.3699278</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,]        1  0.30727947  0.0419906 -0.2489830</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [7,]        1  0.45072209  0.4690995  0.4070466</span></span></code></pre></div>
<p>Weight the predictors using the model fixed effects.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> pred_mat <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">fixef</span>(model))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(weighted) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(pred_mat)</span></code></pre></div>
<p>And do some tidying to plot the two sets of predictors.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_raw <span class="ot">&lt;-</span> <span class="fu">poly_melt</span>(pred_mat)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_raw<span class="sc">$</span>predictors <span class="ot">&lt;-</span> <span class="st">&quot;raw&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df_weighted <span class="ot">&lt;-</span> <span class="fu">poly_melt</span>(weighted)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df_weighted<span class="sc">$</span>predictors <span class="ot">&lt;-</span> <span class="st">&quot;weighted&quot;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>df_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_raw, df_weighted)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Only need the first 7 observations because that is one tree</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_both[df_both<span class="sc">$</span>observation <span class="sc">&lt;=</span> <span class="dv">7</span>, ]) <span class="sc">+</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> observation, <span class="at">y =</span> value, <span class="at">color =</span> degree) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> predictors) <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;term&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The linear trend drives the growth curve. The quadratic and cubic
terms make tiny contributions. We can see that the intercept term does
nothing (because we used <code>scale()</code> in the model).</p>
<p>Hmmm… perhaps we need to find a better example dataset for this
example.</p>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<p>If you searched for help on <code>poly()</code>, see also:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/19484053/what-does-the-r-function-poly-really-do">What
does the R function <code>poly()</code> really do?</a></li>
<li><a href="https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4bec010bc89e6/src/library/stats/R/contr.poly.R#L85">Source
code for the poly function</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
